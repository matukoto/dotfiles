# aqua設定

このディレクトリには[aqua](https://aquaproj.github.io/)の設定ファイルが含まれています。

## ファイル構成

- `aqua.yaml`: aquaのメイン設定ファイル
- `aqua-checksums.json`: パッケージのチェックサム情報

## チェックサム検証とは

チェックサム検証は、ダウンロードしたパッケージのバイナリファイルが改ざんされていないことを確認するセキュリティ機能です。
各パッケージのチェックサム（ハッシュ値）を事前に記録しておき、インストール時に実際のファイルのチェックサムと照合することで、ファイルの整合性を保証します。

### 導入の目的

このリポジトリでチェックサム検証を導入した理由：

1. **サプライチェーン攻撃からの保護**: パッケージの配布経路で改ざんされたバイナリが混入することを防ぎます
2. **ダウンロードエラーの検出**: ネットワークエラーなどによる破損したファイルのインストールを防ぎます
3. **再現性の保証**: 同じバージョンのパッケージが常に同じバイナリであることを保証します

セキュリティ向上のため、チェックサム検証が有効化されています。

### チェックサムの生成

新しいパッケージを追加した後、または既存のパッケージのバージョンを更新した後は、以下のコマンドでチェックサムを生成してください：

```bash
aqua update-checksum --all
```

### チェックサムの自動更新

GitHub Actionsを使用して、`aqua.yaml`の変更時にチェックサムを自動的に更新します。

RenovateなどでパッケージのバージョンがPull Requestで更新されると、`.github/workflows/aqua-checksum-update.yaml`ワークフローが自動実行され、チェックサムファイルを更新するコミットが追加されます。

これにより、手動でチェックサムを更新する手間が省け、常に最新のチェックサムが維持されます。

### 参考資料

- [aqua チェックサム検証のハンドブック](https://zenn.dev/shunsuke_suzuki/books/aqua-handbook/viewer/checksum-verification)
- [aqua 公式ドキュメント](https://aquaproj.github.io/)
